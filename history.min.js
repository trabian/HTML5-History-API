(function(v){"function"===typeof define&&define.amd?define("object"!==typeof document||"loading"!==document.readyState?[]:"html5-history-api",v):v()})(function(){function v(){}function l(a,b,c){if(null==a||""===a||b){if(a=b?a:f.href,!s||c)a=a.replace(/^[^#]*/,"")||"#",a=f.protocol.replace(/:.*$|$/,":")+"//"+f.host+h.basepath+a.replace(new RegExp("^#[/]?(?:"+h.type+")?"),"")}else{b=l();var e=g.getElementsByTagName("base")[0];!c&&e&&e.getAttribute("href")&&(e.href=e.href,b=l(e.href,null,!0));c=b._pathname;
e=b._protocol;a=""+a;a=/^(?:\w+\:)?\/\//.test(a)?0===a.indexOf("/")?e+a:a:e+"//"+b._host+(0===a.indexOf("/")?a:0===a.indexOf("?")?c+a:0===a.indexOf("#")?c+b._search+a:c.replace(/[^\/]+$/g,"")+a)}O.href=a;a=/(?:(\w+\:))?(?:\/\/(?:[^@]*@)?([^\/:\?#]+)(?::([0-9]+))?)?([^\?#]*)(?:(\?[^#]+)|\?)?(?:(#.*))?/.exec(O.href);b=a[2]+(a[3]?":"+a[3]:"");c=a[4]||"/";var e=a[5]||"",d="#"===a[6]?"":a[6]||"",p=c+e+d,w=c.replace(new RegExp("^"+h.basepath,"i"),h.type)+e;return{_href:a[1]+"//"+b+p,_protocol:a[1],_host:b,
_hostname:a[2],_port:a[3]||"",_pathname:c,_search:e,_hash:d,_relative:p,_nohash:w,_special:w+d}}function Z(){var a;try{a=d.sessionStorage,a.setItem("__historyAPI__t","1"),a.removeItem("__historyAPI__t")}catch(b){a={getItem:function(a){a=g.cookie.split(a+"=");return 1<a.length&&a.pop().split(";").shift()||"null"},setItem:function(a,b){var c={};if(c[f.href]=k.state)g.cookie=a+"="+t.stringify(c)}}}try{q=t.parse(a.getItem("__historyAPI__"))||{}}catch(c){q={}}x(y+"unload",function(){a.setItem("__historyAPI__",
t.stringify(q))},!1)}function z(a,b,c,e){var f=0;c||(c={set:v},f=1);var g=!c.set,w=!c.get,J={configurable:!0,set:function(){g=1},get:function(){w=1}};try{D(a,b,J),a[b]=a[b],D(a,b,c)}catch(ha){}if(!g||!w)if(a.__defineGetter__&&(a.__defineGetter__(b,J.get),a.__defineSetter__(b,J.set),a[b]=a[b],c.get&&a.__defineGetter__(b,c.get),c.set&&a.__defineSetter__(b,c.set)),!g||!w){if(f)return!1;if(a===d){try{var $=a[b];a[b]=null}catch(ia){}if("execScript"in d)d.execScript("Public "+b,"VBScript"),d.execScript("var "+
b+";","JavaScript");else try{D(a,b,{value:v})}catch(l){}a[b]=$}else try{try{var k=F.create(a);D(F.getPrototypeOf(k)===a?k:a,b,c);for(var h in a)"function"===typeof a[h]&&(k[h]=a[h].bind(a));try{e.call(k,k,a)}catch(m){}a=k}catch(n){D(a.constructor.prototype,b,c)}}catch(q){return!1}}return a}function aa(a,b,c){c=c||{};a=a===K?f:a;c.set=c.set||function(c){a[b]=c};c.get=c.get||function(){return a[b]};return c}function ba(a,b,c){a in A?A[a].push(b):3<arguments.length?x(a,b,c,arguments[3]):x(a,b,c)}function ca(a,
b,c){var d=A[a];if(d)for(a=d.length;a--;){if(d[a]===b){d.splice(a,1);break}}else P(a,b,c)}function G(a,b){var c=(""+("string"===typeof a?a:a.type)).replace(/^on/,""),e=A[c];if(e){b="string"===typeof a?b:a;if(null==b.target)for(var f=["target","currentTarget","srcElement","type"];a=f.pop();)b=z(b,a,{get:"type"===a?function(){return c}:function(){return d}});(("popstate"===c?d.onpopstate:d.onhashchange)||v).call(d,b);for(var f=0,g=e.length;f<g;f++)e[f].call(d,b);return!0}return da(a,b)}function Q(){var a=
g.createEvent?g.createEvent("Event"):g.createEventObject();a.initEvent?a.initEvent("popstate",!1,!1):a.type="popstate";a.state=k.state;G(a)}function u(a,b,c,d){s?B=f.href:(0===m&&(m=2),b=l(b,2===m&&-1!==(""+b).indexOf("#")),b._relative!==l()._relative&&(B=d,c?f.replace("#"+b._special):f.hash=b._special));!H&&a&&(q[f.href]=a);E=!1}function L(a){var b=B;B=f.href;if(b){R!==f.href&&Q();a=a||d.event;var b=l(b,!0),c=l();a.oldURL||(a.oldURL=b._href,a.newURL=c._href);b._hash!==c._hash&&G(a)}}function S(a){setTimeout(function(){x("popstate",
function(a){R=f.href;H||(a=z(a,"state",{get:function(){return k.state}}));G(a)},!1)},0);!s&&!0!==a&&"location"in k&&(T(r.hash),E&&(E=!1,Q()))}function ea(a){a=a||d.event;var b;a:{for(b=a.target||a.srcElement;b;){if("A"===b.nodeName)break a;b=b.parentNode}b=void 0}var c="defaultPrevented"in a?a.defaultPrevented:!1===a.returnValue;b&&"A"===b.nodeName&&!c&&(c=l(),b=l(b.getAttribute("href",2)),c._href.split("#").shift()===b._href.split("#").shift()&&b._hash&&(c._hash!==b._hash&&(r.hash=b._hash),T(b._hash),
a.preventDefault?a.preventDefault():a.returnValue=!1))}function T(a){var b=g.getElementById(a=(a||"").replace(/^#/,""));b&&b.id===a&&"A"===b.nodeName&&(a=b.getBoundingClientRect(),d.scrollTo(I.scrollLeft||0,a.top+(I.scrollTop||0)-(I.clientTop||0)))}function fa(){function a(a){var b=[],e="VBHistoryClass"+(new Date).getTime()+c++,f=["Class "+e],g;for(g in a)if(a.hasOwnProperty(g)){var h=a[g];h&&(h.get||h.set)?(h.get&&f.push("Public "+("_"===g?"Default ":"")+"Property Get ["+g+"]","Call VBCVal([(accessors)].["+
g+"].get.call(me),["+g+"])","End Property"),h.set&&f.push("Public Property Let ["+g+"](val)",h="Call [(accessors)].["+g+"].set.call(me,val)\nEnd Property","Public Property Set ["+g+"](val)",h)):(b.push(g),f.push("Public ["+g+"]"))}f.push("Private [(accessors)]","Private Sub Class_Initialize()","Set [(accessors)]="+e+"FactoryJS()","End Sub","End Class","Function "+e+"Factory()","Set "+e+"Factory=New "+e,"End Function");d.execScript(f.join("\n"),"VBScript");d[e+"FactoryJS"]=function(){return a};e=d[e+
"Factory"]();for(f=0;f<b.length;f++)e[b[f]]=a[b[f]];return e}function b(a){var b=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return b.test(a)?'"'+a.replace(b,function(a){return a in c?c[a]:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}var c=d.eval&&eval("/*@cc_on 1;@*/");if(c&&!(g.documentMode&&7<g.documentMode)){var e=
z,h=l()._href,p=g.createElement("iframe");p.src="javascript:true;";p=I.firstChild.appendChild(p).contentWindow;d.execScript("Public history\nFunction VBCVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript");r={_:{get:K.toString}};k={back:n.back,forward:n.forward,go:n.go,emulate:null,_:{get:function(){return"[object History]"}}};t={parse:function(a){try{return(new Function("","return "+a))()}catch(b){return null}},stringify:function(a){var c=(typeof a).charCodeAt(2);if(114===
c)a=b(a);else if(109===c)a=isFinite(a)?String(a):"null";else if(111===c||108===c)a=String(a);else if(106===c)if(a){var d=(c="[object Array]"===F.prototype.toString.call(a))?"[":"{";if(c)for(var e=0;e<a.length;e++)d+=(0==e?"":",")+t.stringify(a[e]);else for(e in a)a.hasOwnProperty(e)&&(d+=(1==d.length?"":",")+b(e)+":"+t.stringify(a[e]));a=d+(c?"]":"}")}else a="null";else a="void 0";return a}};u=function(a,b,c,d,e){var g=p.document;0===m&&(m=2);b=l(b,2===m&&-1!==(""+b).indexOf("#"));E=!1;if(b._relative!==
l()._relative||e){B=d;if(c)p.lfirst?(history.back(),u(a,b._href,0,d,1)):f.replace("#"+b._special);else if(b._href!=h||e)p.lfirst?e&&(e=0,a=q[f.href]):(p.lfirst=1,u(a,h,0,d,1)),g.open(),g.write('<script>lfirst=1;parent.location.hash="'+b._special.replace(/"/g,'\\"')+'";\x3c/script>'),g.close();!e&&a&&(q[f.href]=a)}else a&&(q[f.href]=a)};z=function(b,c,f,g){e.apply(this,arguments)||(b===r?r[c]=f:b===k?(k[c]=f,"state"===c&&(r=a(r),d.history=k=a(k),d.execScript("var history = window.history;","JavaScript"))):
b[c]=f.get&&f.get());return b};setInterval(function(){var a=l()._href;if(a!=h){var b=g.createEventObject();b.oldURL=h;b.newURL=h=a;b.type="hashchange";L(b)}},100);d.JSON=t}}var d=("object"===typeof window?window:this)||{};if(!d.history||"emulate"in d.history)return d.history;var g=d.document,I=g.documentElement,F=d.Object,t=d.JSON,f=d.location,n=d.history,k=n,M=n.pushState,U=n.replaceState,s=!!M,H="state"in n,D=F.defineProperty,r=z({},"t")?{}:g.createElement("a"),y="",N=d.addEventListener?"addEventListener":
(y="on","attachEvent"),V=d.removeEventListener?"removeEventListener":"detachEvent",W=d.dispatchEvent?"dispatchEvent":"fireEvent",x=d[N],P=d[V],da=d[W],h={basepath:"/",redirect:0,type:"/"},O=g.createElement("a"),B=f.href,R="",E=!1,m=0,q={},A={},C=g.title,ga={onhashchange:null,onpopstate:null},X=function(a,b){var c=d.history!==n;c&&(d.history=n);a.apply(n,b);c&&(d.history=k)},Y={setup:function(a,b,c){h.basepath=(""+(null==a?h.basepath:a)).replace(/(?:^|\/)[^\/]*$/,"/");h.type=null==b?h.type:b;h.redirect=
null==c?h.redirect:!!c},redirect:function(a,b,c){c=void 0===typeof c?!1:c;k.setup(b,a);b=h.basepath;if(d.top==d.self){a=l(null,!1,!0)._relative;var e=f.pathname+f.search;s?(e=e.replace(/([^\/])$/,"$1/"),a!=b&&(new RegExp("^"+b+"$","i")).test(e)&&f.replace(a)):e==b||c||(e=e.replace(/([^\/])\?/,"$1/?"),(new RegExp("^"+b,"i")).test(e)&&f.replace(b+"#"+e.replace(new RegExp("^"+b,"i"),h.type)+f.hash))}},pushState:function(a,b,c){var d=g.title;null!=C&&(g.title=C);M&&X(M,arguments);u(a,c);g.title=d;C=b},
replaceState:function(a,b,c){var d=g.title;null!=C&&(g.title=C);delete q[f.href];U&&X(U,arguments);u(a,c,!0);g.title=d;C=b},location:{set:function(a){0===m&&(m=1);d.location=a},get:function(){0===m&&(m=1);return s?f:r}},state:{get:function(){return q[f.href]||null}}},K={assign:function(a){0===(""+a).indexOf("#")?u(null,a):f.assign(a)},reload:function(){f.reload()},replace:function(a){0===(""+a).indexOf("#")?u(null,a,!0):f.replace(a)},toString:function(){return this.href},href:{get:function(){return l()._href}},
protocol:null,host:null,hostname:null,port:null,pathname:{get:function(){return l()._pathname}},search:{get:function(){return l()._search}},hash:{set:function(a){u(null,(""+a).replace(/^(#|)/,"#"),!1,B)},get:function(){return l()._hash}}};if(function(){var a=g.getElementsByTagName("script"),a=(a[a.length-1]||{}).src||"";(-1!==a.indexOf("?")?a.split("?").pop():"").replace(/(\w+)(?:=([^&]*))?/g,function(a,b,c){h[b]=(c||"").replace(/^(0|false)$/,"")});fa();x(y+"hashchange",L,!1);var b=[K,r,ga,d,Y,k];
H&&delete Y.state;for(var c=0;c<b.length;c+=2)for(var e in b[c])if(b[c].hasOwnProperty(e))if("function"===typeof b[c][e])b[c+1][e]=b[c][e];else{a=aa(b[c],e,b[c][e]);if(!z(b[c+1],e,a,function(a,e){e===k&&(d.history=k=b[c+1]=a)}))return P(y+"hashchange",L,!1),!1;b[c+1]===d&&(A[e]=A[e.substr(2)]=[])}k.setup();h.redirect&&k.redirect();!H&&t&&Z();if(!s)g[N](y+"click",ea,!1);"complete"===g.readyState?S(!0):(s||l()._relative===h.basepath||(E=!0),x(y+"load",S,!1));return!0}())return k.emulate=!s,d[N]=ba,
d[V]=ca,d[W]=G,k});
